RSpec.describe Inquisition::Bundler::Leak::Vulnerability do
  describe '#to_h' do
    subject(:issue) { described_class.new(advisory) }

    let(:advisory) { instance_double(Bundler::Plumber::Advisory, title: 'Memory leak in formatter middleware') }
    let(:options) do
      {
        severity: Inquisition::Severity::LOW,
        category: Inquisition::Category::PERFORMANCE,
        message: advisory.title,
        path: Inquisition::Bundler::Leak::Vulnerability::GEMFILE,
        line: nil
      }
    end

    it { expect(issue.to_h).to include(options) }
  end
end
