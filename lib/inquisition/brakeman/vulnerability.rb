module Inquisition
  module Brakeman
    class Vulnerability
      MATCH_TABLE = Hash.new(
        Inquisition::Severity::LOW
      ).update(
        0 => Inquisition::Severity::HIGH, 1 => Inquisition::Severity::MEDIUM
      ).freeze

      def initialize(warning)
        @warning = warning
      end

      def to_h
        {
          severity: MATCH_TABLE[warning.confidence],
          message: warning.message.to_s,
          path: warning.relative_path,
          line: warning.line
        }
      end

      private

      attr_reader :warning
    end
  end
end
