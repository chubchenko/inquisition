module Inquisition
  module Brakeman
    class Vulnerability
      MATCH_TABLE = Hash.new(
        Severity::LOW
      ).update(
        0 => Severity::HIGH, 1 => Severity::MEDIUM
      ).freeze

      def initialize(warning)
        @warning = warning
      end

      def to_h
        {
          category: Category::SECURITY,
          severity: MATCH_TABLE[warning.confidence],
          message: warning.message.to_s,
          path: warning.relative_path,
          line: warning.line,
          warning_type: warning.warning_type
        }
      end

      private

      attr_reader :warning
    end
  end
end
