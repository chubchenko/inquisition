.col-md-3.left_col
  .left_col.scroll-view
    .navbar.nav_title{:style => "border: 0;"}
      %a.site_title{:href => "index.html"}
        %i.fa.fa-paw
        %span Code Auditor!
    .clearfix
    .profile.clearfix
      .profile_pic
        %img.img-circle.profile_img{:alt => "...", :src => "images/img.jpg"}/
    %br/
    .main_menu
      %nav#sidebar
        .sidebar-header
          %h3 Reports
        %ul.nav.side-menu
          - menu_items.each do |item|
            %li
              - if item[:child_items] && item[:child_items].any?
                %a.dropdown-toggle{"aria-expanded" => "false", "data-toggle" => "collapse", :href => "##{item[:class]}"}
                  = item[:name]
                  %span.fa.fa-chevron-down
                %ul.collapse.nav.side-menu{ id: item[:class] }
                  - item[:child_items].each do |child_item|
                    %li
                      - if child_item[:child_items] && child_item[:child_items].any?
                        %a.dropdown-toggle{"aria-expanded" => "false", "data-toggle" => "collapse", :href => "##{child_item[:class]}"}
                          = child_item[:name]
                          %span.fa.fa-chevron-down
                        %ul.collapse.nav.side-menu{ id: child_item[:class] }
                          - child_item[:child_items].each do |nested_item|
                            %li
                              %a{:href => "#{nested_item[:link]}"}= nested_item[:name]
                      - else
                        %a{:href => "#{child_item[:link]}"}= child_item[:name]
              - else
                %a{:href => "#{item[:link]}"}= item[:name]
.top_nav
  .nav_menu
    %nav
      .nav.toggle
        %a#menu_toggle
          %i.fa.fa-bars
      %ul.nav.navbar-nav.navbar-right
        %li
          %a.user-profile{:class => "aria-expanded=", :false => "", :href => "javascript:;"}
            %i.fa.fa-envelope-o
            = succeed "code_auditor@rubygarage.org" do
              %img{:alt => "", :src => "images/img.jpg"}/
.right_col{:role => "main"}
  .row.tile_count
    .col-md-2.col-sm-4.col-xs-6.tile_stats_count
      %span.count_top
        %i.fa.fa-table
        Database tables
      .count= tables_count
    .col-md-2.col-sm-4.col-xs-6.tile_stats_count
      %span.count_top
        %i.fa.fa-bug
        Errors found
      .count= total_errors
    .col-md-2.col-sm-4.col-xs-6.tile_stats_count
      %span.count_top
        %i.fa.fa-check-square
        Included auditors
      .count= included_auditors_count
    .col-md-2.col-sm-4.col-xs-6.tile_stats_count
      %span.count_top
        %i.fa.fa-cog
        Migrations count
      .count= total_migrations
    .col-md-2.col-sm-4.col-xs-6.tile_stats_count
      %span.count_top
        %i.fa.fa-database
        Database adapter
      .count= database_adapter
    .col-md-2.col-sm-4.col-xs-6.tile_stats_count
      %span.count_top
        %i.fa.fa-cog
        Schema version
      .count{ style: "font-size: 30px; line-height: 30px;" }
        = schema_version[:date]
        %br
        = schema_version[:time]
  %br/
  .row
    .col-md-12.col-sm-12.col-xs-12
      .x_panel.tile
        .x_title
          %h2 Errors summary in percents
          .clearfix
        .x_content.row
          .col-md-3.col-sm-3.col-xs-12{ style: "text-align:center" }
            %h4 Tables with repeated indexes
            #repeated-indexes-percent.custom-circles{"data-percent" => "#{repeated_indexes_percentage[:percent]}"}
            %small Ratio between numbers of tables with repeated indexes and total tables
            %br
            %small
              100 * tei / tt
              %b where:
            %br
            %small
              %b tei -
              total tables with repeated indexes
            %br
            %small
              %b tt -
              total tables
          .col-md-3.col-sm-3.col-xs-12{ style: "text-align:center" }
            %h4 Tables with missing foreign keys
            #missing-foreign-keys-percent.custom-circles{"data-percent" => "#{missing_foreign_keys_percentage[:percent]}"}
            %small Ratio between numbers of tables with missing foreign keys and total tables
            %br
            %small
              100 * tmk / tt
              %b where:
            %br
            %small
              %b tmk -
              total tables with missing foreign keys
            %br
            %small
              %b tt -
              total tables
          .col-md-3.col-sm-3.col-xs-12{ style: "text-align:center" }
            %h4 Incompatibility tables structure with models
            #incompatibility-structure-percent.custom-circles{"data-percent" => "#{incompatibility_structure_with_models_percentage[:percent]}"}
            %small Ratio between numbers of tables with incompatibility tables structure with models and total tables
            %br
            %small
              100 * tis / tt
              %b where:
            %br
            %small
              %b tis -
              total tables with incompatibility structure with models
            %br
            %small
              %b tt -
              total tables
          .col-md-3.col-sm-3.col-xs-12{ style: "text-align:center" }
            %h4 Unindexed foreign keys
            #unindexed-foreign-keys-percent.custom-circles{"data-percent" => "#{unindexed_foreign_keys_percentage[:percent]}"}
            %small Ratio between unindexed foreign keys with models and total tables
            %br
            %small
              100 * ufk / tt
              %b where:
            %br
            %small
              %b ufk -
              total tables with unindexed foreign keys
            %br
            %small
              %b tt -
              total tables
  .row
    .col-md-6.col-sm-6.col-xs-12
      .x_panel.tile.fixed_height_320
        .x_title
          %h2 Top 5 tables with errors
          .clearfix
        .x_content
          %h4 Tables summary
          - top_tables_with_errors(5).each do |error|
            .widget_summary
              .w_left.w_25
                %span= error[:title]
              .w_center.w_55
                .progress
                  .progress-bar.bg-green{"aria-valuemin" => "0", :role => "progressbar", :style => "width: #{error[:percent]}%;"}
              .w_right.w_20
                %span= error[:number]
              .clearfix
    .col-md-6.col-sm-6.col-xs-12
      .x_panel.tile.fixed_height_320.overflow_hidden
        .x_title
          %h2 Most populate errors
          .clearfix
        .x_content
          %table{:style => "width:100%"}
            %tr
              %th{:style => "width:37%;"}
                %p Top 5
              %th
                .col-lg-7.col-md-7.col-sm-7.col-xs-7
                  %p Error
                .col-lg-5.col-md-5.col-sm-5.col-xs-5
                  %p Tables
            %tr
              %td
                %canvas#most_populars_errors{:height => "140", :style => "margin: 15px 10px 10px 0", :width => "140"}
              %td
                %table.tile_info
                  - top_types_of_errors(5).each do |error|
                    %tr
                      %td
                        %p
                          %i.fa.fa-square{class: "#{error[:color]}"}>
                          = error[:name]
                      %td= error[:total]
