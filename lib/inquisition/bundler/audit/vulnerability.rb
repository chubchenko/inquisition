module Inquisition
  module Bundler
    module Audit
      class Vulnerability
        def to_h
          { path: nil, line: nil, category: Category::SECURITY, warning_type: nil }
        end
      end

      class UnpatchedGem < Vulnerability
        def initialize(advisory)
          @advisory = advisory
        end

        def to_h
          super.merge(
            severity: advisory.criticality || Severity::LOW,
            message: advisory.title.strip
          )
        end

        private

        attr_reader :advisory
      end

      class InsecureSource < Vulnerability
        def initialize(source)
          @source = source
        end

        def to_h
          super.merge(
            severity: Severity::MEDIUM,
            message: message
          )
        end

        private

        attr_reader :source

        def message
          "Insecure Source URI found: #{source}"
        end
      end
    end
  end
end
