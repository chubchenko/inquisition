module Inquisition
  module Bundler
    module Leak
      class Vulnerability
        def initialize(warning)
          @warning = warning
        end

        def to_h
          {
            severity: :low,
            message: "#{warning.gem.name} #{warning.gem.version} - #{warning.advisory.title}",
            path: 'Gemfile.lock',
            line: nil
          }
        end

        private

        attr_reader :warning
      end
    end
  end
end
