module Inquisition
  module Bundler
    module Leak
      class Vulnerability
        GEMFILE = 'Gemfile.lock'.freeze

        def initialize(advisory)
          @advisory = advisory
        end

        def to_h
          {
            severity: Severity::MEDIUM,
            category: Category::PERFORMANCE,
            message: advisory.title,
            path: GEMFILE,
            line: nil,
            warning_type: nil
          }
        end

        private

        attr_reader :advisory
      end
    end
  end
end
