module Inquisition
  module Bundler
    module Leak
      class Vulnerability
        GEMFILE = 'Gemfile.lock'.freeze

        def initialize(advisory)
          @advisory = advisory
        end

        def to_h
          {
            severity: Inquisition::Severity::LOW,
            category: Inquisition::Category::PERFORMANCE,
            message: advisory.title,
            path: GEMFILE,
            line: nil
          }
        end

        private

        attr_reader :advisory
      end
    end
  end
end
